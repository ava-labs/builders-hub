---
title: Removing a Validator Theory
description: Theory walkthrough of removing a validator with ValidatorManager owned by an EOA, including L1 and P-Chain calls.
updated: 2025-03-19
authors: [nicolasarnedo]
icon: BookOpen
---

## Removing a Validator

You're removing an existing Active validator in a PoA setup where the `ValidatorManager` contract is owned by an EOA. The flow has two L1 calls with P-Chain processing in between.

### Phase 1: Initiation (L1)

The owner calls `initiateValidatorRemoval(validationID)` on `ValidatorManager`.

Under the hood, the contract:
- Ensures the validator is currently Active
- Sets the validator status to `PendingRemoved`
- Sets the end time of the current validation period to the current timestamp
- Persists updates and constructs a weight message with `weight = 0`
- Sends a Warp message to the P-Chain (removal is encoded as a weight update to zero)

### Phase 2: P-Chain Processing

The P-Chain receives the `L1ValidatorWeightMessage` and executes a `SetL1ValidatorWeightTx`. Upon successful processing, it acknowledges the validator exit by signing an `L1ValidatorRegistrationMessage` with `valid = 0` and returns it to L1 via Warp.

### Phase 3: Completion (L1)

The owner calls `completeValidatorRemoval(message)`. The contract verifies the Warp message, confirms the registration status is false, updates the validator's status to Completed (if previously `PendingRemoved`), removes the node from the registered mapping, persists updates, and emits `CompletedValidatorRemoval`.

### Sequence Diagram

<Mermaid
  chart="
sequenceDiagram
    participant EOA_Owner as EOA Owner
    participant ValidatorManager as ValidatorManager
    participant WarpMessenger as WarpMessenger (precompile)
    participant PChain as P-Chain

    %% Phase 1: Initiation
    EOA_Owner->>ValidatorManager: initiateValidatorRemoval(validationID)

    ValidatorManager->>ValidatorManager: _initiateValidatorRemoval()

    ValidatorManager->>ValidatorManager: Validate Active status

    ValidatorManager->>ValidatorManager: Set status = PendingRemoved<br/>Set validation end time

    ValidatorManager->>ValidatorManager: Save validator updates

    ValidatorManager->>WarpMessenger: sendWarpMessage(weightMessage(weight=0))

    %% Phase 2: P-Chain Processing
    WarpMessenger->>PChain: Deliver L1ValidatorWeightMessage(weight=0)

    PChain-->>WarpMessenger: Signed L1ValidatorRegistrationMessage(valid=0)

    %% Phase 3: Completion
    EOA_Owner->>ValidatorManager: completeValidatorRemoval(message)

    ValidatorManager->>ValidatorManager: Verify Warp message<br/>Check valid == false

    ValidatorManager->>ValidatorManager: Set status = Completed<br/>Remove from registered validators

    ValidatorManager-->>EOA_Owner: emit CompletedValidatorRemoval

    %% Optional: Resend
    EOA_Owner-->>ValidatorManager: resendValidatorRemovalMessage(validationID)
"
/>

## What you'll do next

In the practical section, you will:
1. Initiate the removal from L1
2. Submit the corresponding P-Chain transaction (weight to 0)
3. Complete the removal back on L1 with the signed Warp message

## Appendix: Removing Validator Flow

<Mermaid
  chart="
sequenceDiagram
    participant EOA_Owner as EOA Owner
    participant ValidatorManager as ValidatorManager
    participant WarpMessenger as WarpMessenger (precompile)
    participant PChain as P-Chain

    %% Phase 1: Initiation
    EOA_Owner->>ValidatorManager: initiateValidatorRemoval(validationID)

    ValidatorManager->>ValidatorManager: _initiateValidatorRemoval()

    ValidatorManager->>ValidatorManager: Validate Active status

    ValidatorManager->>ValidatorManager: Set status = PendingRemoved<br/>Set validation end time

    ValidatorManager->>ValidatorManager: Save validator updates

    ValidatorManager->>WarpMessenger: sendWarpMessage(weightMessage(weight=0))

    %% Phase 2: P-Chain Processing
    WarpMessenger->>PChain: Deliver L1ValidatorWeightMessage(weight=0)

    PChain-->>WarpMessenger: Signed L1ValidatorRegistrationMessage(valid=0)

    %% Phase 3: Completion
    EOA_Owner->>ValidatorManager: completeValidatorRemoval(message)

    ValidatorManager->>ValidatorManager: Verify Warp message<br/>Check valid == false

    ValidatorManager->>ValidatorManager: Set status = Completed<br/>Remove from registered validators

    ValidatorManager-->>EOA_Owner: emit CompletedValidatorRemoval

    %% Optional: Resend
    EOA_Owner-->>ValidatorManager: resendValidatorRemovalMessage(validationID)
"
/>


