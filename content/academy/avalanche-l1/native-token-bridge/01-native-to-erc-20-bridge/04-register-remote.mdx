---
title: Register Remote Bridge
description: Register the ERC20TokenRemote contract with the NativeTokenHome contract.
updated: 2024-05-31
authors: [owenwahlgren]
icon: BookOpen
---

import { Step, Steps } from 'fumadocs-ui/components/steps';

# Register Remote with Home

After deploying both contracts, you must **register the remote contract with the home contract**. This establishes the secure, bidirectional connection that enables token transfers.

## Why Registration is Required

Registration serves several critical purposes:

| Purpose | Description |
|---------|-------------|
| **Security** | Only registered remotes can receive tokens from the home |
| **Accounting** | The home tracks balances per registered remote |
| **Configuration** | Token scaling and multipliers are set during registration |
| **Trust** | Both sides cryptographically verify each other |

## How Registration Works

```
Destination Chain                              Source Chain
┌─────────────────────┐                       ┌─────────────────────┐
│ ERC20TokenRemote    │                       │ NativeTokenHome     │
│                     │    1. Register Call   │                     │
│ registerWithHome()  │ ───────────────────▶  │                     │
│                     │    (ICM Message)      │                     │
│                     │                       │ Stores remote info  │
│                     │                       │ - Blockchain ID     │
│                     │                       │ - Remote address    │
│                     │                       │ - Token settings    │
└─────────────────────┘                       └─────────────────────┘
```

1. You call `registerWithHome()` on the **remote contract** (destination chain)
2. The remote sends an ICM message to the **home contract** (source chain)
3. The home contract stores the remote's information
4. The bridge connection is now established

<Steps>
<Step>
### Stay on Destination Chain

Keep your wallet connected to **Echo** (or your destination chain). The registration call is initiated from the remote contract.

</Step>

<Step>
### Register Remote with Home

Use the Register With Home tool below. You'll need to:

1. Select the **source chain** (where NativeTokenHome is deployed)
2. Enter the **Remote Contract Address** (your ERC20TokenRemote)

<Callout type="info">
The toolbox will automatically detect your deployed contracts and offer them as suggestions.
</Callout>

<Callout type="warning">
Make sure you have:
1. Successfully deployed your ERC20TokenRemote contract
2. Sufficient test ECH for gas fees
</Callout>

<ToolboxMdxWrapper enforceChainId={173750}>
    <RegisterWithHome />
</ToolboxMdxWrapper>

</Step>

<Step>
### Wait for ICM Message

After submitting the registration:

1. A transaction is sent on the destination chain
2. An ICM message is relayed to the source chain
3. The home contract processes the registration
4. The toolbox updates to show "Registered" status

<Callout type="info">
ICM message relay typically takes a few seconds. If the status doesn't update, click the "Refresh" button in the tool.
</Callout>

</Step>

<Step>
### Verify Registration

The tool shows the registration status:

- ✅ **Remote contract is registered with the Home contract** = Success!
- ⚠️ **Not yet registered** = Wait for ICM message or check for errors

You can also verify by checking the events on the home contract (shown in the tool).

</Step>
</Steps>

## What Happens During Registration

When `registerWithHome()` is called:

```solidity
// On the Remote contract (simplified)
function registerWithHome(FeeInfo calldata feeInfo) external {
    // Send ICM message to home chain
    ITeleporterMessenger(teleporterAddress).sendCrossChainMessage(
        TeleporterMessageInput({
            destinationBlockchainID: tokenHomeBlockchainID,
            destinationAddress: tokenHomeAddress,
            message: abi.encode(REGISTER_REMOTE_MESSAGE, ...)
        })
    );
}
```

The home contract then:

```solidity
// On the Home contract (simplified)  
function _handleRegisterRemote(...) internal {
    // Store remote contract info
    remoteSettings[remoteBlockchainID][remoteAddress] = RemoteSettings({
        registered: true,
        collateralNeeded: 0, // For ERC20TokenRemote
        tokenMultiplier: 1,
        multiplyOnRemote: false
    });
}
```

## Troubleshooting

### Registration Not Showing

If the registration doesn't appear:

1. **Wait longer**: ICM relay may take time depending on relayer configuration
2. **Check relayer**: Ensure your relayer is running and configured for both chains
3. **Verify addresses**: Confirm you used the correct home and remote addresses

### Transaction Failed

If the registration transaction fails:

1. **Insufficient gas**: Ensure you have enough native tokens for fees
2. **Wrong chain**: Verify you're on the destination chain
3. **Already registered**: You can't register the same remote twice

## Bridge State After Registration

Your bridge is now configured:

| Component | Status |
|-----------|--------|
| NativeTokenHome (Fuji) | ✅ Deployed, ✅ Knows about remote |
| ERC20TokenRemote (Echo) | ✅ Deployed, ✅ Registered |
| Bridge Connection | ✅ Established |
| Token Transfers | ✅ Ready |

## Next Steps

With registration complete, you can now **transfer tokens** across the bridge!
